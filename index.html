<!DOCTYPE html>
<html lang="en">
	<head>
		<title>an orbit's cool page</title>
		<link rel="stylesheet" href="main.css"/>
		<script>
try {
			bigintValue = 0n;
			lifetimeBigintValue = 0n;
			showedMessage = false;
			superUpgradeVisible = false;
			bigintRebirths = 0n;
			saveModulo = 0;
			
			clickUpgrades = [
				{type: "+",		value: 1n,		cost: 10n,		level: 0n},
				{type: "+",		value: 5n,		cost: 40n,		level: 0n},
				{type: "+",		value: 12n,		cost: 100n,		level: 0n},
				{type: "+",		value: 150n,		cost: 1000n,	level: 0n},
				{type: "*",		value: 2n,		cost: 50000n,	level: 0n,	max: 4n},
				{type: "+",		value: 15000n,	cost: 75000n,	level: 0n},
				{type: "**",	value: 2n,		cost: 10n**7n,	level: 0n,	max: 1n},
				{type: "**",	value: 3n,		cost: 10n**14n,	level: 0n,	max: 1n},
				{type: "**",	value: 4n,		cost: 10n**21n,	level: 0n,	max: 1n}
			];

buyKeys = {};

var letters = "pqweㅇt";
var letters2 = "lasdㅇg";
/*TODO: AZERTY and QWERTZ support*/
var upperLetters = letters.toUpperCase();
var upperLetters2 = letters2.toUpperCase();
var shiftNumbers = ")!@#ㅇ%";

for(var number = 0; number < letters.length; number++) {
  shiftNumber = shiftNumbers[number];
  letter = letters[number];
  if(letter == "ㅇ") { continue };
  uLetter = upperLetters[number];
  letter2 = letters2[number];
  uLetter2 = upperLetters2[number];

  buyKeys[number] = [number, 0n];
  buyKeys[shiftNumber] = [number, 1n];
  buyKeys[letter] = [number, 2n];
  buyKeys[uLetter] = [number, 3n];
  buyKeys[letter2] = [number, 4n];
  buyKeys[uLetter2] = [number, 5n];
};

doNotAlertRebirth = false;			

BigInt.prototype.toJSON = function() { return "<@BI>" + this.toString() }

function bigintReviver (key, value) {
	if(typeof(value) == "string" && value.startsWith("<@BI>")) {
		var bi = value.substring(5);
    return BigInt(bi);
	};
	return value;
};

			function saveBigints() {
				object = {
					number: bigintValue,
					lifetimeNumber: lifetimeBigintValue,
					reachedBigNumber: showedMessage,
					upgradeLevels: clickUpgrades.map(x => x.level),
					showUpgradeOT12: superUpgradeVisible,
					modhaus: bigintRebirths
				};
				localStorage.setItem("number",JSON.stringify(object));
			};

			function resetBigints(removeSave=false) {
				bigintValue = 0n;
				lifetimeBigintValue = 0n;
				showedMessage = false;
				superUpgradeVisible = false;
				bigintRebirths = 0n;
				for(hash = 0; hash < clickUpgrades.length; hash++) {
					clickUpgrades[hash].level = 0n;
				};
				relockSecret();
				updateCounters();
				if(removeSave) { localStorage.removeItem("number") }; return true;
			};

			function loadBigints() {
				if(!localStorage.number) { return false }; object = JSON.parse(localStorage.number,bigintReviver);
				bigintValue = object.number;
				lifetimeBigintValue = object.lifetimeNumber;
				showedMessage = object.reachedBigNumber;
				superUpgradeVisible = object.showUpgradeOT12;
				bigintRebirths = object.modhaus;
				var levels = object.upgradeLevels; for(ptt = 0; ptt < levels.length; ptt++) { clickUpgrades[ptt].level = levels[ptt] };

				if(superUpgradeVisible) {
					unlockSecret();
				}; updateCounters(false); return true;
			};

			function rebirth(updateCounts=true) {
				if(bigintValue < (10n**112n)) {
					return false;
				};
				bigintValue = 0n; showedMessage = false;
				for(hash = 0; hash < clickUpgrades.length; hash++) {
					clickUpgrades[hash].level = 0n;
				};
				bigintRebirths += 1n;
				if(updateCounts) {
					buildUpgradeInfoList(); updateCounters();
				};
				return true;
			};

function getUpgradeInfo(index) {
  var upgrade = clickUpgrades[index];

  var amountText = upgrade.max ? `${upgrade.level}/${upgrade.max}` : upgrade.level.toString();

  var rebirthModifier = 2n ** bigintRebirths;
  var benefitPrefix, upgradeValue;
  switch(upgrade.type) {
    case "+":
      benefitPrefix = "+";
      upgradeValue = (rebirthModifier * upgrade.value) * upgrade.level;
      break;
    case "*":
      benefitPrefix = "x";
      upgradeValue = (upgrade.value + bigintRebirths) ** upgrade.level;
      break;
    case "**":
      benefitPrefix = "^";
      upgradeValue = upgrade.level == 0 ? 1n : upgrade.value * upgrade.level;
      break;
  };

  var benefitText = `${benefitPrefix}${upgradeValue}`

  var baseBenefit = `${benefitPrefix}${upgrade.value}`

  var cost = upgrade.cost;

  return `Upgrade ${index}: ${cost}, ${baseBenefit} (${amountText}, ${benefitText})`;
};

function buildUpgradeInfoList() {
  var element = document.getElementById("upList");
  element.textContent = "";
  rebirthSpan = document.createElement("span");
  rebirthSpan.setAttribute("class","upgradeInfo rebirths ot12");
  rebirthSpan.innerText = `Rebirths: ${bigintRebirths} (x2 to + upgrades and base click, +1 to x upgrades; total +x${2n ** bigintRebirths} and x+${bigintRebirths})`;
  element.appendChild(rebirthSpan);
  element.appendChild(document.createElement("br"));
  var bound = clickUpgrades.length;
  for(l = 0; l < bound; l++) {
    infoRow = document.createElement("span");
    infoRow.setAttribute("class","upgradeInfo");
    infoRow.innerText = getUpgradeInfo(l);
    element.appendChild(infoRow);
    element.appendChild(document.createElement("br"));
  };
  resultSpan = document.createElement("span");
  resultSpan.setAttribute("class","upgradeInfo totalClick ot12");
  var CV = getClickValue(); resultSpan.innerText = `Final click value: [*e${bigintCommas(getBigintMagnitude(CV))}] ${bigintCommas(CV)}`;
  element.appendChild(resultSpan);
};

			function getClickValue() {
				var rebirthedBase = 2n ** bigintRebirths;
				var value = rebirthedBase;
				for(flipThat = 0; flipThat < clickUpgrades.length; flipThat++) {
					var upgrade = clickUpgrades[flipThat];
					if(upgrade.type == "+") {
						value += ((upgrade.value * rebirthedBase) * upgrade.level);
					} else if(upgrade.type == "*") {
						if(upgrade.level > 0) { value *= ((upgrade.value + bigintRebirths) ** upgrade.level) };
					} else if(upgrade.type == "**") {
						if(upgrade.level > 0) { value = value ** (upgrade.value * upgrade.level) };
					} else {
						console.warn(`Unknown upgrade type "${upgrade.type}" for upgrade ${flipThat}`);
					};
				};
				return value;
			};
			
			function buyUpgrade(index,updateCounts=true,amount=1n) {
				var upgrade = clickUpgrades[index];
				var cost = upgrade.cost * amount;

				if(bigintValue < cost) {
					return false;
				};

				if(upgrade.max && (upgrade.level > (upgrade.max - amount))) {
					return false;
				};
				
				upgrade.level += amount;
				bigintValue -= cost;
				if(updateCounts) {
					updateCounters();
					buildUpgradeInfoList();
				};
				
				if(index == 6) {
					unlockSecret();
				}; unlockUplist();
				
				return true;
			};

			function unlockSecret() {
				var secretSpan = document.getElementById("up7");
				if(secretSpan && secretSpan.style.display == "none") {
					secretSpan.style.display = "unset";
				};
				superUpgradeVisible = true;
			};
			
			function relockSecret() {
				var secretSpan = document.getElementById("up7");
				if(secretSpan && (secretSpan.style.display == "" || secretSpan.style.display == "unset")) {
					secretSpan.style.display = "none";
				};
				superUpgradeVisible = false;
			};

			function unlockUplist() {
				var secretDiv = document.getElementById("upList");
                                if(!secretDiv) { return }; buildUpgradeInfoList();
				if(secretDiv && secretDiv.style.display == "none") {
					secretDiv.style.display = "unset";
				};
			};
			
			function relockUplist() {
				var secretDiv = document.getElementById("upList");
				if(secretDiv && (secretDiv.style.display == "" || secretDiv.style.display == "unset")) {
					secretDiv.style.display = "none";
				};
			};

			
			function increment(updateCounts=true) {
				bigintValue += getClickValue();
				lifetimeBigintValue += getClickValue();
				if(updateCounts) {
					updateCounters();
				};
			};

			function bigintCommas(bigint) {
				var numberText = bigint.toString().replaceAll(/(?=\d)(?=(\d\d\d)+(?!\d))/g,",");
				if(numberText.startsWith(",")) { numberText = numberText.substring(1) };
				return numberText;
			};

function getBigintMagnitude(bigint) {
  var bString = bigint.toString();
  return BigInt(bString.length - (bString.startsWith("-") ? 2 : 1));
};

			function updateCounters(doSave=true) {
				if(lifetimeBigintValue >= (10n**11n)) {
					unlockSecret();
				};
				
				if(!showedMessage && bigintValue >= (10n**112n) && (!doNotAlertRebirth)) {
					alert("congartulations you have reached 10 short scale octotrigintilllion orbit\n(you can now rebirht too)");
					showedMessage = true;
				};
			
				var counters = document.querySelectorAll("[countTemplate]"); //find nodes with a countTemplate
				for(i = 0; i < counters.length; i++) {
					var counter = counters[i];
					var format = counter.getAttribute("countTemplate");
					var magnitudeOffset = BigInt(counter.getAttribute("templateMagnitudeOffset") ?? "0");
					var numberText = bigintCommas(bigintValue * (10n ** magnitudeOffset));
					var numberMagnitudeText = bigintCommas(getBigintMagnitude(bigintValue * (10n ** magnitudeOffset)));
					var newText = format.replaceAll("<@N@>",numberText).replaceAll("<@E@>",numberMagnitudeText);
					counter.innerText = newText;
				};

if(doSave) { //Save on every fifth update
  saveModulo++;
  if(saveModulo % 5 == 0) {
    saveBigints();
    saveModulo = 0;
  };
};
			};
			
			function generateButtonsForTitledClickables() {
				var clickables = document.querySelectorAll("[onclick][title]"); //find nodes with an onclick and a title
				for(i = 0; i < clickables.length; i++) {
					var clickText = clickables[i];
					var clickCode = clickText.getAttribute("onclick");
					var textTitle = clickText.getAttribute("title");
					var newButton = document.createElement("button");
					newButton.setAttribute("onclick",clickCode);
					newButton.innerText = textTitle;
					clickText.after(newButton);
				};
				return true;
			};

			function dumbBruh() {
				try {
					var audio = new Audio("bruh.mp3");
					audio.onended = function() {
						delete(this);
					};
					audio.play();
				} catch (error) {
					alert("Could not play bruh sound");
					return false;
				};
				return true;
			};

			document.addEventListener("keypress", function(event) {
				if (event.key === " ") {
					increment(true);
					return true;
				} else if (event.key === "b") {
					return rebirth();
				} else if (Object.keys(buyKeys).includes(event.key)) {
					purchaseData = buyKeys[event.key];
					return buyUpgrade(purchaseData[0],true,25n ** purchaseData[1]);
				};
			});

window.onload = function() {
  loadBigints();
  buildUpgradeInfoList();
  setInterval(saveBigints, 5000);
  if(getClickValue() > 1) { buildUpgradeInfoList(); unlockUplist() };
};

} catch(error) {
    alert(error);
};
		</script>
		<style>
			@keyframes fade-in {
			  from { opacity: 0 }
			  to { opacity: 1 }
			}

			@keyframes blink {
			  0% { opacity: 0 }
			  49.999999999% { opacity: 0 }
			  50.000000001% { opacity: 1 }
			  100% { opacity: 1 }
			}

			.blink { animation: blink 1s linear 0s infinite normal none; }

			.hoverTest {
				opacity: 0;
			}
			.hoverTest:hover {
				opacity: 1;
				animation: 0.35s linear 0s 1 normal fade-in
			}
		</style>
	</head>
	<body>
		<div id="header">
			<marquee class="ot12" style="font-size:130%;" direction="right" scrolldelay="60" behavior="alternate">helo this is my github page i really love loona and kpop</marquee>
		</div>
		
		<div id="main">
			<p>hi i'm an <span title="rebirth" onclick="rebirth()">orbit</span> and i really love loona<span class="hoverTest">; loona is the only thing that keeps me alive every day</span><br/>
			please <a href="https://drive.google.com/drive/folders/15nOtXlSIKYD_anDn7PtDimHiyByzrjFa?usp=share_link">don't stream</a>; the girls <a href="https://reddit.com/r/LOONA/comments/zrd8di/bbcloona_contract_leads_to_debt_bondage_tables/">don't get anything</a> for it<br/>
			<span onclick="buyUpgrade(1)" title="up1">i love all of</span> <span onclick="buyUpgrade(2)" title="up2">the members and</span> <span onclick="buyUpgrade(3)" title="up3">all of their songs</span> <span onclick="buyUpgrade(5)" title="up5">too (and it's too hard to pick a bias)</span><br/>
			<span title="orbits" onclick="increment(true);" countTemplate="i wish there were [*e<@E@>] <@N@> orbits" templateMagnitudeOffset="6">i love orbits</span><br/>
			<span onclick="buyUpgrade(0)" title="up0">loona</span> <span onclick="buyUpgrade(6)" title="up6">ot12</span> <span onclick="buyUpgrade(4)" title="up4">forever</span><span onclick="buyUpgrade(7)" class="ot12" id="up7" title="up7" style="display: none"> (super-special secret eighth upgrade)</span></p>
		
			<h1 class="ot12">my epic pages with great quality code</h1>
				<a href="random-loona.html" class="third">loona permuter</a><br/>
				<a href="modded-char8/index.html" class="yeojin">heavily modded char8.js</a><br/>
				<a href="starbound.html" class="circle">starbound color text renderer</a><br/>
				<a href="mp3.html" class="youth">ersatz mp3 player</a><br/>
				<a href="thirds.html" class="third">two-way extension of seconds and thirds</a><br/>
				<a href="bbc.json" class="yeojin">(.json file) blockberry creative save for modded </a><a href="https://sandboxels.r74n.com" class="youth">sandboxels</a><br/>
				<a href="bbc.html" class="yeojin">(html/click-to-copy) blockberry creative save for modded </a><a href="https://sandboxels.r74n.com" class="youth">sandboxels</a><br/>
				<a href="illions.html" class="circle">pseudo-bowers illion name generator</a><br/>
				<a href="urltoimg.html" class="youth">dumb html image loader</a><br/>
				<a href="eod-paths/index.html" class="ot12">EoD paths</a><br/>

			<h1 class="ot12">not epic code</h1>
				<span class="third">groups: <strong>loona</strong> (ult) <code class="yeojin">//TODO: stan more groups</code></span><br/>
				<span class="yeojin">antis, akgaes dni<span class="hoverTest"> (especially bahiyyih antis)</span></span><br/>
			
			<br/><br/>
			<button id="buttonButton" onclick="alert(generateButtonsForTitledClickables())">Buttons</button> and a <input title="useless textbox" placeholder="useless textbox"/><br/>
			<span class="blink" title="click to bruh" countTemplate="this page would be [*e<@E@>] <@N@> times more obnoxious if we still had &lt;blink&gt; tags" onclick="dumbBruh(); increment(true);">this page would be even more obnoxious if we still had &lt;blink&gt; tags</span><br/>
                        <div id="upList" style="display: none;">Upgrade list goes here</div>
		</div>
	</body>
</html>
